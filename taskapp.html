<!doctype html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="description" content="">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Vue Task App</title>
	<link rel="stylesheet" href="css/normalize.css">
	<link rel="stylesheet" href="css/taskapp.css">
</head>
<body>
	<div id="app">
		<task-list v-ref:task-list v-bind:list="tasks"></task-list>
		<ui v-ref:ui v-bind:tags="tags" v-bind:colours="colours"></ui>
		<p>SelectedId: {{ selectedId }}<br>EditingId: {{ editingId }}</p>
		<p> {{ $refs.ui.tags | json }}</p>
	</div>
	<!-- end of Vue app container -->

	<!-- First component template -->
	<template id="task-list-tpl" v-on:click="selectedId = null">
		<h1>My Tasks ({{ remaining }})</h1>

		<span>Filter:</span>
		<form id="filter" v-bind:search="search">
			<input v-model.trim="search">
			<i class="fa fa-times-circle" aria-hidden="true" v-on:click="search = ''"></i>
		</form>

		<ul id="task-ul" v-show="list.length > 0">
			<li class="list-item flex-container"
				v-for="(index, task) in list | filterBy search"
				data-id="{{ index }}"
				v-bind:class="{completed: task.completed, selected: task.id == selectedId}"
				v-on:click="select(task.id)">

				<div class="group">
					{{ index }}
					<input type="checkbox" v-model="task.completed">

					<!-- Task body: -->
					<span v-show="editingId !== task.id" class="task-body">{{ task.body }} {{ task.id }}</span>
					<input v-show="editingId == task.id" v-model="task.body" placeholder="New task"
						   v-on:keyup.enter="editingId = null">
				</div>

				<div class="group">
					<!-- Colours: -->
					<span v-for="(i, c) in task.colours | filterBy search"
						  class="colour" v-bind:class="c" v-on:click="deleteColour(task.id, c)">
					</span>
					<!-- Tags: -->
					<span v-for="(i, t) in task.tags | filterBy search"
					  	  class="tag" v-on:click="deleteTag(task.id, t)">
						  {{ t }}
					</span>
				</div>
				<div class="group">
					<!-- Task actions: -->
					<span class="editBtn" v-on:click="editTask(task.id)">
						{{ editingId == task.id ? 'Save' : 'Edit' }}
					</span>
					<i class="fa fa-trash-o" aria-hidden="true" v-on:click="deleteTask(task.id)"></i>
				</div>
			</li>
		</ul>
		<p v-else>No tasks here.</p>

		<div>
			<form id="task-buttons">
				<button v-on:click.prevent="newTask" v-on:keyup.n="newTask">Add Task</button>
				<button v-show="list.length > 0" v-on:click.prevent="clearCompleted">Clear Completed</button>
			</form>
		</div>
	</template>

	<!-- Second component template -->
	<template id="ui-tpl">
		<div id="tag-list" v-bind:class="{editing: editingTags}">
			<p>Tags:
				<span class="editBtn" v-on:click="toggleEditingGlobalTags">
					{{ editingTags ? 'Close' : 'Edit' }}
				</span>
			</p>
			<div class="flex-container">
				<span v-for="t in tags">
					<span class="tag" v-on:click="$parent.$refs.task-list.addTag(t)">
					  {{ t }}
					</span>
					<i v-show="editingTags" class="fa fa-trash-o" aria-hidden="true" v-on:click="deleteGlobalTag(t)"></i>
				</span>
			</div>
			<form v-show="editingTags">
				<input size="10" v-model.trim="newTag" placeholder="tag" v-on:keyup.enter="addGlobalTag(newTag)">
				<button type="submit" v-on:click.prevent="addGlobalTag(newTag)">Add Tag</button>
			</form>
		</div>

		<div id="colour-list">
			<p>Colours:</p>
			<span v-for="c in colours"
				  class="colour"
				  :class="c"
				  v-on:click="addColour(c)">
			</span>
		</div>
	</template>


	<!--script src="js/zepto.min.js"></script-->
	<!--script src="js/vue.2.0.1.js"></script-->
	<script src="js/mousetrap.js"></script>
	<script src="js/vue.1.0.28.js"></script>
	<script src="js/Sortable.js"></script>
	<script src="js/taskapp.js"></script>
	<script src="https://use.fontawesome.com/bfab10ea54.js"></script>
</body>
</html>
